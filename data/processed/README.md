# 📊 전처리된 데이터 설명서

## 📋 파일 정보
- **생성일**: 2025-07-29 (기존), 2025-01-27 (하수도 인프라 데이터 추가)
- **생성 스크립트**: `scripts/data_preprocessing.py`, `scripts/preprocess_sewer_data.py`
- **데이터 소스**: `data/raw/` 폴더의 원본 데이터

## 🎯 전처리 목적
자연재해 위험도, 노후주택 현황, 하수도 인프라 데이터를 통합하여 주거취약지수 및 하수도 인프라 지수 계산에 활용할 수 있는 형태로 가공

## 📁 전처리된 데이터 파일 목록

### 1. `processed_data.csv` (기존)
- **용도**: 주거취약지수 분석용
- **생성일**: 2025-07-29
- **크기**: 948B (19 lines)

### 2. `sewer_infrastructure_processed.csv` (신규)
- **용도**: 하수도 인프라 지수 분석용
- **생성일**: 2025-01-27
- **크기**: 163KB (2400 lines)
- **생성 스크립트**: `scripts/preprocess_sewer_data.py`

### 3. `sewer_infrastructure_analysis.csv` (신규)
- **용도**: 하수도 인프라 분석 결과
- **생성일**: 2025-01-27
- **크기**: 270KB (2400 lines)
- **생성 스크립트**: `notebooks/02_sewer_infrastructure_analysis.ipynb`

## 📁 원본 데이터

### 1. 자연재해 위험도 데이터 (`Natural_Disaster_Risk.csv`)
- **출처**: 국토교통부 자연재해 위험지구 현황
- **기간**: 2023년
- **내용**: 지역별 자연재해 위험지구 등급별 현황
- **등급 구분**:
  - **가등급**: 인명피해 위험 (최고 위험)
  - **나등급**: 건축물 피해 위험 (중간 위험)
  - **다등급**: 기반시설 피해 위험 (낮은 위험)

### 2. 노후주택 비율 데이터 (`aged_housing_ratio.csv`)
- **출처**: 통계청 주택보급률 통계
- **기간**: 2020-2023년 (2023.2 분기 데이터 사용)
- **내용**: 지역별 30년 이상 노후주택 현황
- **지표**: 노후주택비율, 노후주택 수, 전체 주택 수

### 3. 하수도 보급률 데이터 (`Sewer_Coverage_Rate.csv`) (신규)
- **출처**: 한국환경공단 하수도 보급률 통계
- **기간**: 2023년 기준
- **내용**: 지역별 하수도 인프라 현황
- **주요 지표**:
  - 하수도 설치율
  - 공공하수처리구역 인구보급률
  - 고도처리인구 보급률
  - 총인구, 총면적

## 🔧 전처리 과정

### 1단계: 데이터 로딩
```python
# 원본 데이터 파일 로딩
disaster_risk = pd.read_csv("data/raw/Natural_Disaster_Risk.csv")
housing_ratio = pd.read_csv("data/raw/aged_housing_ratio.csv")
sewer_data = pd.read_csv("data/raw/Sewer_Coverage_Rate.csv")  # 신규
```

### 2단계: 자연재해 위험도 데이터 전처리
```python
# 1. 헤더 정리 (첫 번째, 두 번째 행을 컬럼명으로 설정)
# 2. 2023년 데이터만 선택
# 3. 숫자형 데이터 변환
# 4. 컬럼명 정리: region, total_risk, high_risk, medium_risk, low_risk
```

**전처리 전**:
```
"행정구역별(1)",2023,2023,2023,2023
"행정구역별(1)",합계,가 등급,나 등급,다 등급
"서울특별시",16,10,4,2
```

**전처리 후**:
```
region,total_risk,high_risk,medium_risk,low_risk
서울특별시,16,10,4,2.0
```

### 3단계: 노후주택 비율 데이터 전처리
```python
# 1. 헤더 정리 (첫 번째, 두 번째 행을 컬럼명으로 설정)
# 2. 2023.2 분기 데이터만 선택 (최신 데이터)
# 3. 숫자형 데이터 변환
# 4. 컬럼명 정리: region, aged_housing_ratio, aged_housing_count, total_housing_count
```

**전처리 전**:
```
행정구역별(시군구),2023,2023.1,2023.2
행정구역별(시군구),노후주택비율(A÷B×100) (%),30년 이상 노후주택(A) (호),전체주택(B) (호)
서울특별시,26.0,820267,3155331
```

**전처리 후**:
```
region,aged_housing_ratio,aged_housing_count,total_housing_count
서울특별시,26.0,820267,3155331
```

### 4단계: 하수도 데이터 전처리 (신규)
```python
# 1. 필요한 컬럼만 선택
essential_cols = ['시도', '행정구역명', '총인구(명)', '총면적', 
                 '하수도설치율', '공공하수처리구역 인구보급률', '고도처리인구 보급률']

# 2. 결측값 처리 (세종특별자치시 구군 컬럼 제외)
# 3. 이상값 처리 (0-100 범위)
# 4. 인구 밀도 계산 (명/km²)
# 5. 인구 밀도 이상값 처리 (50,000명/km² 이하)
```

### 5단계: 지역명 통일 및 데이터 통합
```python
# 지역명 매핑 딕셔너리 사용
region_mapping = {
    '강원특별자치도': '강원도',
    '전북특별자치도': '전라북도',
    # ... 기타 지역명 통일
}

# 두 데이터셋을 region 기준으로 통합 (inner join)
merged_data = pd.merge(disaster_data, housing_data, on='region', how='inner')
```

## 📊 최종 데이터 구조

### processed_data.csv (기존)
| 컬럼명 | 설명 | 단위 | 데이터 타입 |
|--------|------|------|-------------|
| `region` | 지역명 | - | 문자열 |
| `total_risk` | 전체 자연재해 위험지구 수 | 개 | 정수 |
| `high_risk` | 가등급 위험지구 수 (인명피해 위험) | 개 | 정수 |
| `medium_risk` | 나등급 위험지구 수 (건축물 피해 위험) | 개 | 실수 |
| `low_risk` | 다등급 위험지구 수 (기반시설 피해 위험) | 개 | 실수 |
| `aged_housing_ratio` | 30년 이상 노후주택 비율 | % | 실수 |
| `aged_housing_count` | 30년 이상 노후주택 수 | 호 | 정수 |
| `total_housing_count` | 전체 주택 수 | 호 | 정수 |

### sewer_infrastructure_processed.csv (신규)
| 컬럼명 | 설명 | 단위 | 데이터 타입 |
|--------|------|------|-------------|
| `시도` | 시도명 | - | 문자열 |
| `행정구역명` | 행정구역명 | - | 문자열 |
| `총인구(명)` | 총 인구수 | 명 | 정수 |
| `총면적` | 총 면적 | km² | 실수 |
| `하수도설치율` | 하수도 설치율 | % | 실수 |
| `공공하수처리구역 인구보급률` | 공공하수처리구역 인구보급률 | % | 실수 |
| `고도처리인구 보급률` | 고도처리인구 보급률 | % | 실수 |
| `인구밀도` | 인구 밀도 | 명/km² | 실수 |

### sewer_infrastructure_analysis.csv (신규)
위의 모든 컬럼 + 분석 결과 컬럼들:
- `인구밀도_정규화`: 0-100 스케일로 정규화된 인구 밀도
- `하수도_인프라_지수`: 가중 평균으로 계산된 종합 인프라 지수
- `인프라_등급`: 등급별 분류 (매우 낮음/낮음/보통/높음)

## 🔍 데이터 품질 관리

### 결측치 처리
- **대전광역시 low_risk**: 원본 데이터에서 `-`로 표시된 값을 0으로 처리
- **세종특별자치시 구군**: NaN 값 허용 (특수 행정구역)
- **이유**: 해당 지역에 다등급 위험지구가 없음을 의미

### 데이터 검증
- **지역명 일치성**: 17개 시도 모두 매칭 확인
- **숫자형 변환**: 모든 수치 데이터의 올바른 변환 확인
- **범위 검증**: 
  - 위험지구 수: 0 이상의 정수
  - 노후주택비율: 0-100% 범위
  - 주택 수: 0 이상의 정수
  - 하수도 관련 지표: 0-100% 범위
  - 인구 밀도: 50,000명/km² 이하

## 📈 활용 방안

### 1. 주거취약지수 계산 (기존)
```python
# 취약지수 = (전체위험도 × 0.4) + (고위험도 × 0.3) + (노후주택비율 × 0.3)
vulnerability_index = (
    total_risk * 0.4 + 
    high_risk * 0.3 + 
    aged_housing_ratio * 0.3
)
```

### 2. 하수도 인프라 지수 계산 (신규)
```python
# 인프라 지수 = (하수도설치율 × 0.3) + (공공하수처리구역 × 0.3) + 
#               (고도처리 × 0.2) + (인구밀도_정규화 × 0.2)
infrastructure_index = (
    sewer_coverage * 0.3 +
    public_sewer * 0.3 +
    advanced_treatment * 0.2 +
    population_density_normalized * 0.2
)
```

### 3. 지역별 비교 분석
- 위험도 등급별 분포 분석
- 노후주택 현황 분석
- 하수도 인프라 현황 분석
- 지역간 취약성 및 인프라 격차 비교

### 4. 시각화
- 지도 기반 시각화
- 차트 및 그래프 생성
- 인터랙티브 대시보드

## 🚨 주의사항

1. **데이터 출처**: 공식 통계 데이터 사용
2. **시점**: 2023년 기준 데이터
3. **지역 범위**: 시도 단위 (17개 지역, 세종특별자치시 포함)
4. **업데이트**: 원본 데이터 변경 시 재전처리 필요
5. **세종특별자치시**: 구군 컬럼이 없는 특수 행정구역으로 처리

## 🔄 데이터 업데이트 이력

| 날짜 | 업데이트 내용 | 파일 |
|------|---------------|------|
| 2025-07-29 | 초기 전처리 데이터 생성 | processed_data.csv |
| 2025-07-30 | 하수도 인프라 데이터 추가 | sewer_infrastructure_processed.csv |
| 2025-07-30 | 하수도 인프라 분석 결과 추가 | sewer_infrastructure_analysis.csv |

---
**마지막 업데이트**: 2025-07-30  
**전처리 버전**: 2.0 (하수도 인프라 데이터 추가) 